<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta charset="utf-8">
<meta http-equiv="cache-control" content="no-cache" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="-1" />
<!--
   Note to customizers: the body of the webrev is IDed as SUNWwebrev
   to allow easy overriding by users of webrev via the userContent.css
   mechanism available in some browsers.

   For example, to have all "removed" information be red instead of
   brown, set a rule in your userContent.css file like:

       body#SUNWwebrev span.removed { color: red ! important; }
-->
<style type="text/css" media="screen">
body {
    background-color: #eeeeee;
}
hr {
    border: none 0;
    border-top: 1px solid #aaa;
    height: 1px;
}
div.summary {
    font-size: .8em;
    border-bottom: 1px solid #aaa;
    padding-left: 1em;
    padding-right: 1em;
}
div.summary h2 {
    margin-bottom: 0.3em;
}
div.summary table th {
    text-align: right;
    vertical-align: top;
    white-space: nowrap;
}
span.lineschanged {
    font-size: 0.7em;
}
span.oldmarker {
    color: red;
    font-size: large;
    font-weight: bold;
}
span.newmarker {
    color: green;
    font-size: large;
    font-weight: bold;
}
span.removed {
    color: brown;
}
span.changed {
    color: blue;
}
span.new {
    color: blue;
    font-weight: bold;
}
a.print { font-size: x-small; }

</style>

<style type="text/css" media="print">
pre { font-size: 0.8em; font-family: courier, monospace; }
span.removed { color: #444; font-style: italic }
span.changed { font-weight: bold; }
span.new { font-weight: bold; }
span.newmarker { font-size: 1.2em; font-weight: bold; }
span.oldmarker { font-size: 1.2em; font-weight: bold; }
a.print {display: none}
hr { border: none 0; border-top: 1px solid #aaa; height: 1px; }
</style>

<title>New make/defs.make</title>
<body id="SUNWwebrev">
<pre>
   1 #
   2 # Copyright (c) 2006, 2013, Oracle and/or its affiliates. All rights reserved.
   3 # DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
   4 #
   5 # This code is free software; you can redistribute it and/or modify it
   6 # under the terms of the GNU General Public License version 2 only, as
   7 # published by the Free Software Foundation.
   8 #
   9 # This code is distributed in the hope that it will be useful, but WITHOUT
  10 # ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  11 # FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
  12 # version 2 for more details (a copy is included in the LICENSE file that
  13 # accompanied this code).
  14 #
  15 # You should have received a copy of the GNU General Public License version
  16 # 2 along with this work; if not, write to the Free Software Foundation,
  17 # Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
  18 #
  19 # Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA
  20 # or visit www.oracle.com if you need additional information or have any
  21 # questions.
  22 #
  23 #
  24 
  25 # The common definitions for hotspot builds.
  26 
  27 # Optionally include SPEC file generated by configure.
  28 ifneq ($(SPEC),)
  29   include $(SPEC)
  30 endif
  31 
  32 ifeq ($(LOG_LEVEL),warn)
  33   LOG_INFO := &gt; /dev/null
  34 else
  35   LOG_INFO :=
  36 endif
  37 
  38 # Directory paths and user name
  39 # Unless GAMMADIR is set on the command line, search upward from
  40 # the current directory for a parent directory containing "src/share/vm".
  41 # If that fails, look for $GAMMADIR in the environment.
  42 # When the tree of subdirs is built, this setting is stored in each flags.make.
  43 GAMMADIR := $(shell until ([ -d dev ]&amp;&amp;echo $${GAMMADIR:-/GAMMADIR/}) || ([ -d src/share/vm ]&amp;&amp;pwd); do cd ..; done)
  44 HS_SRC_DIR=$(GAMMADIR)/src
  45 HS_MAKE_DIR=$(GAMMADIR)/make
  46 HS_BUILD_DIR=$(GAMMADIR)/build
  47 
  48 ifeq ($(USER),)
  49   USER=$(USERNAME)
  50 endif
  51 
  52 ifeq ($(HS_ALT_MAKE),)
  53   ifneq ($(OPENJDK),true)
  54     HS_ALT_MAKE=$(GAMMADIR)/make/closed
  55   else
  56     HS_ALT_MAKE=NO_SUCH_PATH
  57   endif
  58 endif
  59 
  60 #
  61 # Include alternate defs.make if it exists
  62 #
  63 -include $(HS_ALT_MAKE)/defs.make
  64 
  65 # Default to verbose build logs (show all compile lines):
  66 MAKE_VERBOSE=y
  67 
  68 # Make macros for install files or preparing targets
  69 CD=cd
  70 CP=cp
  71 ECHO=echo
  72 GREP=grep
  73 MKDIR=mkdir
  74 MV=mv
  75 PWD=pwd
  76 RM=rm -f
  77 SED=sed
  78 TAR=tar
  79 ZIPEXE=zip
  80 
  81 define install-file
  82 @$(MKDIR) -p $(@D)
  83 @$(RM) $@
  84 $(CP) $&lt; $@
  85 endef
  86 
  87 # MacOS X strongly discourages 'cp -r' and provides 'cp -R' instead.
  88 # May need to have a MacOS X specific definition of install-dir
  89 # sometime in the future.
  90 define install-dir
  91 @$(MKDIR) -p $(@D)
  92 @$(RM) -r $@
  93 $(CP) -r $&lt; $@
  94 endef
  95 
  96 define prep-target
  97 @$(MKDIR) -p $(@D)
  98 @$(RM) $@
  99 endef
 100 
 101 # Default values for JVM_VARIANT* variables if configure hasn't set
 102 # it already.
 103 ifeq ($(JVM_VARIANTS),)
 104   ifeq ($(ZERO_BUILD), true)
 105     ifeq ($(SHARK_BUILD), true)
 106       JVM_VARIANTS:=zeroshark
 107       JVM_VARIANT_ZEROSHARK:=true
 108     else
 109       JVM_VARIANTS:=zero
 110       JVM_VARIANT_ZERO:=true
 111     endif
 112   else
 113     # A default is needed
 114     ifeq ($(BUILD_CLIENT_ONLY), true)
 115       JVM_VARIANTS:=client
 116       JVM_VARIANT_CLIENT:=true
 117     endif
 118     # Further defaults are platform and arch specific
 119   endif
 120 endif
 121 
 122 # hotspot version definitions
 123 include $(GAMMADIR)/make/jdk_version
 124 
 125 # Java versions needed
 126 ifeq ($(PREVIOUS_JDK_VERSION),)
 127   PREVIOUS_JDK_VERSION=$(JDK_PREVIOUS_VERSION)
 128 endif
 129 ifeq ($(JDK_MAJOR_VERSION),)
 130   JDK_MAJOR_VERSION=$(JDK_MAJOR_VER)
 131 endif
 132 ifeq ($(JDK_MINOR_VERSION),)
 133   JDK_MINOR_VERSION=$(JDK_MINOR_VER)
 134 endif
 135 ifeq ($(JDK_MICRO_VERSION),)
 136   JDK_MICRO_VERSION=$(JDK_MICRO_VER)
 137 endif
 138 ifeq ($(JDK_BUILD_NUMBER),)
 139   JDK_BUILD_NUMBER=0
 140 endif
 141 ifeq ($(JDK_MKTG_VERSION),)
 142   JDK_MKTG_VERSION=$(JDK_MINOR_VERSION).$(JDK_MICRO_VERSION)
 143 endif
 144 ifeq ($(JDK_VERSION),)  
 145   ifeq ($(BUILD_FLAVOR), product)
 146     JDK_VERSION=$(JDK_MAJOR_VERSION).$(JDK_MINOR_VERSION).$(JDK_MICRO_VERSION)
 147   else
 148     JDK_VERSION=$(JDK_MAJOR_VERSION).$(JDK_MINOR_VERSION).$(JDK_MICRO_VERSION)-$(BUILD_FLAVOR)
 149   endif
 150 endif
 151 ifeq ($(FULL_VERSION),)
 152   FULL_VERSION="$(JDK_VERSION)"
 153 endif
 154 
 155 # FULL_VERSION is only used to define JRE_RELEASE_VERSION which is used
 156 # as JRE version in VM -Xinternalversion output.
 157 ifndef JRE_RELEASE_VERSION
 158   JRE_RELEASE_VERSION=$(FULL_VERSION)
 159 endif
 160 
 161 ifndef HOTSPOT_RELEASE_VERSION
 162   HOTSPOT_RELEASE_VERSION=$(FULL_VERSION)
 163 endif
 164 
 165 ifdef HOTSPOT_BUILD_VERSION
 166 # specified in command line
 167 else
 168   ifdef COOKED_BUILD_NUMBER
 169 # JRE build
 170     HOTSPOT_BUILD_VERSION=
 171   else
 172     ifdef USER_RELEASE_SUFFIX
 173       HOTSPOT_BUILD_VERSION=internal-$(USER_RELEASE_SUFFIX)
 174     else
 175       HOTSPOT_BUILD_VERSION=internal
 176     endif
 177   endif
 178 endif
 179 
 180 # Windows should have OS predefined
 181 ifeq ($(OS),)
 182   OS   := $(shell uname -s)
 183   ifneq ($(findstring BSD,$(OS)),)
 184     OS=bsd
 185   endif
 186   ifeq ($(OS), Darwin)
 187     OS=bsd
 188   endif
 189   HOST := $(shell uname -n)
 190 endif
 191 
 192 # If not SunOS, not Linux not BSD and not AIX, assume Windows
 193 ifneq ($(OS), Linux)
 194   ifneq ($(OS), SunOS)
 195     ifneq ($(OS), bsd)
 196       ifneq ($(OS), AIX)
 197         OSNAME=windows
 198       else
 199         OSNAME=aix
 200       endif
 201     else
 202       OSNAME=bsd
 203     endif
 204   else
 205     OSNAME=solaris
 206   endif
 207 else
 208   OSNAME=linux
 209 endif
 210 
 211 # Determinations of default make arguments and platform specific settings
 212 MAKE_ARGS=
 213 
 214 # ARCH_DATA_MODEL==64 is equivalent to LP64=1
 215 ifeq ($(ARCH_DATA_MODEL), 64)
 216   ifndef LP64
 217     LP64 := 1
 218   endif
 219 endif
 220 
 221 # Defaults set for product build
 222 EXPORT_SUBDIR=
 223 
 224 # Change default /java path if requested
 225 ifneq ($(ALT_SLASH_JAVA),)
 226   SLASH_JAVA=$(ALT_SLASH_JAVA)
 227 endif
 228 
 229 # Default OUTPUTDIR
 230 OUTPUTDIR=$(HS_BUILD_DIR)/$(OSNAME)
 231 ifneq ($(ALT_OUTPUTDIR),)
 232   OUTPUTDIR=$(ALT_OUTPUTDIR)
 233 endif
 234 
 235 # Find latest promoted JDK area
 236 JDK_IMPORT_PATH=$(SLASH_JAVA)/re/j2se/$(JDK_VERSION)/promoted/latest/binaries/$(PLATFORM)
 237 ifneq ($(ALT_JDK_IMPORT_PATH),)
 238   JDK_IMPORT_PATH=$(ALT_JDK_IMPORT_PATH)
 239 endif
 240 
 241 # Other parts of JDK build may require an import JDK that can be executed
 242 # on the build host. For cross-compile builds we also need an import JDK
 243 # that matches the target arch, so for that we set ALT_JDK_TARGET_IMPORT_PATH
 244 ifneq ($(ALT_JDK_TARGET_IMPORT_PATH),)
 245   JDK_IMPORT_PATH=$(ALT_JDK_TARGET_IMPORT_PATH)
 246 endif
 247 
 248 # Find JDK used for javac compiles
 249 BOOTDIR=$(SLASH_JAVA)/re/j2se/$(PREVIOUS_JDK_VERSION)/latest/binaries/$(PLATFORM)
 250 ifneq ($(ALT_BOOTDIR),)
 251   BOOTDIR=$(ALT_BOOTDIR)
 252 endif
 253 
 254 # Select name of the export directory and honor ALT overrides
 255 EXPORT_PATH=$(OUTPUTDIR)/export-$(PLATFORM)$(EXPORT_SUBDIR)
 256 ifneq ($(ALT_EXPORT_PATH),)
 257   EXPORT_PATH=$(ALT_EXPORT_PATH)
 258 endif
 259 
 260 # Default jdk image if one is created for you with create_jdk
 261 JDK_IMAGE_DIR=$(OUTPUTDIR)/jdk-$(PLATFORM)
 262 ifneq ($(ALT_JDK_IMAGE_DIR),)
 263   JDK_IMAGE_DIR=$(ALT_JDK_IMAGE_DIR)
 264 endif
 265 
 266 # The platform dependent defs.make defines platform specific variable such
 267 # as ARCH, EXPORT_LIST etc. We must place the include here after BOOTDIR is defined.
 268 include $(GAMMADIR)/make/$(OSNAME)/makefiles/defs.make
 269 
 270 # We are trying to put platform specific defintions
 271 # files to make/$(OSNAME)/makefiles dictory. However
 272 # some definitions are common for both linux and solaris,
 273 # so we put them here.
 274 ifneq ($(OSNAME),windows)
 275   ABS_OUTPUTDIR     := $(shell mkdir -p $(OUTPUTDIR); $(CD) $(OUTPUTDIR); $(PWD))
 276   ABS_BOOTDIR       := $(shell $(CD) $(BOOTDIR); $(PWD))
 277   ABS_GAMMADIR      := $(shell $(CD) $(GAMMADIR); $(PWD))
 278   ABS_OS_MAKEFILE   := $(shell $(CD) $(HS_MAKE_DIR)/$(OSNAME); $(PWD))/Makefile
 279 
 280   # uname, HotSpot source directory, build directory and JDK use different names
 281   # for CPU architectures.
 282   #   ARCH      - uname output
 283   #   SRCARCH   - where to find HotSpot cpu and os_cpu source files
 284   #   BUILDARCH - build directory
 285   #   LIBARCH   - directory name in JDK/JRE
 286 
 287   # Use uname output for SRCARCH, but deal with platform differences. If ARCH
 288   # is not explicitly listed below, it is treated as x86.
 289   SRCARCH     = $(ARCH/$(filter sparc sparc64 ia64 amd64 x86_64 arm ppc ppc64 zero,$(ARCH)))
 290   ARCH/       = x86
 291   ARCH/sparc  = sparc
 292   ARCH/sparc64= sparc
 293   ARCH/ia64   = ia64
 294   ARCH/amd64  = x86
 295   ARCH/x86_64 = x86
 296   ARCH/ppc64  = ppc
 297   ARCH/ppc    = ppc
 298   ARCH/arm    = arm
 299   ARCH/zero   = zero
 300 
 301   # BUILDARCH is usually the same as SRCARCH, except for sparcv9
 302   BUILDARCH = $(SRCARCH)
 303   ifeq ($(BUILDARCH), x86)
 304     ifdef LP64
 305       BUILDARCH = amd64
 306     else
 307       BUILDARCH = i486
 308     endif
 309   endif
 310   ifeq ($(BUILDARCH), sparc)
 311     ifdef LP64
 312       BUILDARCH = sparcv9
 313     endif
 314   endif
 315   ifeq ($(BUILDARCH), ppc)
 316     ifdef LP64
 317       BUILDARCH = ppc64
 318     endif
 319   endif
 320 
 321   # LIBARCH is 1:1 mapping from BUILDARCH
 322   LIBARCH         = $(LIBARCH/$(BUILDARCH))
 323   LIBARCH/i486    = i386
 324   LIBARCH/amd64   = amd64
 325   LIBARCH/sparc   = sparc
 326   LIBARCH/sparcv9 = sparcv9
 327   LIBARCH/ia64    = ia64
 328   LIBARCH/ppc64   = ppc64
 329   LIBARCH/ppc     = ppc
 330   LIBARCH/arm     = arm
 331   LIBARCH/zero    = $(ZERO_LIBARCH)
 332 
 333   # Override LIBARCH for ppc64le
 334   ifeq ($(BUILDARCH), ppc64)
 335     ifeq ($(OPENJDK_TARGET_CPU_ENDIAN), little)
 336       LIBARCH = ppc64le
 337     endif
 338   endif
 339 
 340   LP64_ARCH = sparcv9 amd64 ia64 ppc64 zero
 341 endif
 342 
 343 # Required make macro settings for all platforms
 344 MAKE_ARGS += BOOTDIR=$(ABS_BOOTDIR)
 345 MAKE_ARGS += OUTPUTDIR=$(ABS_OUTPUTDIR)
 346 MAKE_ARGS += GAMMADIR=$(ABS_GAMMADIR)
 347 MAKE_ARGS += MAKE_VERBOSE=$(MAKE_VERBOSE)
 348 MAKE_ARGS += JRE_RELEASE_VERSION=$(JRE_RELEASE_VERSION)
 349 
 350 # Pass HOTSPOT_BUILD_VERSION as argument to OS specific Makefile
 351 # to overwrite the default definition since OS specific Makefile also
 352 # includes this make/defs.make file.
 353 MAKE_ARGS += HOTSPOT_BUILD_VERSION=$(HOTSPOT_BUILD_VERSION)
 354 
 355 # Various export sub directories
 356 EXPORT_INCLUDE_DIR = $(EXPORT_PATH)/include
 357 EXPORT_DOCS_DIR = $(EXPORT_PATH)/docs
 358 EXPORT_LIB_DIR = $(EXPORT_PATH)/lib
 359 EXPORT_JRE_DIR = $(EXPORT_PATH)/jre
 360 EXPORT_JRE_BIN_DIR = $(EXPORT_JRE_DIR)/bin
 361 EXPORT_JRE_LIB_DIR = $(EXPORT_JRE_DIR)/lib
 362 EXPORT_JRE_LIB_ARCH_DIR = $(EXPORT_JRE_LIB_DIR)/$(LIBARCH)
 363 
 364 # non-universal macosx builds need to appear universal
 365 ifeq ($(OS_VENDOR), Darwin)
 366   ifneq ($(MACOSX_UNIVERSAL), true)
 367     EXPORT_JRE_LIB_ARCH_DIR = $(EXPORT_JRE_LIB_DIR)
 368   endif
 369 endif
 370 
 371 # Common export list of files
 372 EXPORT_LIST += $(EXPORT_INCLUDE_DIR)/jvmti.h
 373 EXPORT_LIST += $(EXPORT_INCLUDE_DIR)/jvmticmlr.h
 374 EXPORT_LIST += $(EXPORT_INCLUDE_DIR)/jni.h
 375 EXPORT_LIST += $(EXPORT_INCLUDE_DIR)/$(JDK_INCLUDE_SUBDIR)/jni_md.h
 376 EXPORT_LIST += $(EXPORT_INCLUDE_DIR)/jmm.h
 377 
 378 .PHONY: $(HS_ALT_MAKE)/defs.make
 379 
</pre></body></html>
